@test
subroutine test_BD_DisplacementQP()
    ! test branches
    ! - inputs from static_cantilever_beam reg test
    
    use pFUnit_mod
    use BeamDyn
    use NWTC_Num
    use test_tools
    
    implicit none
    
    integer(IntKi)  :: nelem
    integer(IntKi)  :: nqp
    integer(IntKi)  :: node_elem_idx(1, 2)
    integer(IntKi)  :: nodes_per_elem
    real(BDKi)      :: Shp(6, 6)
    real(BDKi)      :: ShpDer(6, 6)
    real(BDKi)      :: Jacobian(6, 1)
    real(BDKi)      :: E10(3, 6, 1)
    real(BDKi)      :: q(6, 6)
    real(BDKi)      :: uuu(6, 6, 1), base_uuu(6, 6)
    real(BDKi)      :: uup(3, 6, 1), base_uup(3, 6)
    real(BDKi)      :: E1(3, 6, 1), base_E1(3, 6)
    
    character(1024) :: testname
    integer(IntKi)  :: accuracy
    real(BDKi)      :: tolerance
    
    ! initialize NWTC_Num constants
    call SetConstants()
    
    ! digits of desired accuracy
    accuracy = 16
    
    ! --------------------------------------------------------------------------
    testname = "inputs from static_cantilever_beam reg test:"

    nelem               = 1
    nqp                 = 6
    node_elem_idx(1, :) = (/ 1, 6 /)
    nodes_per_elem      = 6

    Shp            = reshape((/ 0.56810033719119868, 0.54600529904618211, -0.17100059377928215,&
                                9.0891014410089913E-002, -5.3848422698494762E-002, 1.9852365830306046E-002,&
                               -0.11491298888938235, 0.89325443712116914, 0.29872729762554340,&
                               -0.11867075135711064, 6.5037607493123609E-002, -2.3435601993343175E-002,&
                                2.0974134603267917E-002, -7.2277727371205455E-002, 0.98837526121682617,&
                                8.7945809764163108E-002, -3.7910305851169689E-002, 1.2892827638118033E-002,&
                                1.2892827638118030E-002, -3.7910305851169702E-002, 8.7945809764163094E-002,&
                                0.98837526121682640, -7.2277727371205441E-002, 2.0974134603267913E-002,&
                               -2.3435601993343175E-002, 6.5037607493123623E-002, -0.11867075135711061,&
                                0.29872729762554345, 0.89325443712116881, -0.11491298888938237,&
                                1.9852365830306043E-002, -5.3848422698494769E-002, 9.0891014410089926E-002,&
                               -0.17100059377928217, 0.54600529904618200, 0.56810033719119879 /),&
                             (/ 6, 6 /))
    ShpDer         = reshape((/ -5.3662878602968807, 6.1891420050127399, -1.1811237271300947,&
                                 0.56200870295456273, -0.32046265756488884, 0.11672353702456187,&
                                -0.52977478969671288, -1.8470255894016800, 3.0534805435837153,&
                                -1.0227628175586183, 0.53740791255480702, -0.19132525948151155,&
                                 0.41194219818106076, -1.3772032075754475, -0.49385314772443095,&
                                 2.0106901064298413, -0.83213986458353861, 0.28056391527251617,&
                                -0.28056391527251606, 0.83213986458353861, -2.0106901064298404,&
                                 0.49385314772443106, 1.3772032075754475, -0.41194219818106081,&
                                 0.19132525948151144, -0.53740791255480713, 1.0227628175586179,&
                                -3.0534805435837162, 1.8470255894016798, 0.52977478969671266,&
                                -0.11672353702456185, 0.32046265756488879, -0.56200870295456284,&
                                 1.1811237271300949, -6.1891420050127381, 5.3662878602968815 /),&
                             (/ 6, 6 /))
    Jacobian(:, 1) = (/ 5.0000000000000000, 4.9999999999999964, 5.0000000000000071,&
                        5.0000000000000009, 4.9999999999999920, 5.0000000000000213 /)
    E10(:, :, 1)   = reshape((/ 0.0000000000000000, 0.0000000000000000, 1.0000000000000000,&
                                0.0000000000000000, 0.0000000000000000, 1.0000000000000000,&
                                0.0000000000000000, 0.0000000000000000, 1.0000000000000000,&
                                0.0000000000000000, 0.0000000000000000, 1.0000000000000000,&
                                0.0000000000000000, 0.0000000000000000, 1.0000000000000000,&
                                0.0000000000000000, 0.0000000000000000, 1.0000000000000000 /),&
                             (/ 3, 6 /))
    q              = 0.0d0
    uuu            = 0.0d0
    uup            = 0.0d0
    E1             = 0.0d0
    base_uuu       = 0.0d0
    base_uup       = 0.0d0
    base_E1(:, :)  = E10(:, :, 1)
    
    call BD_DisplacementQP( nelem, nqp, node_elem_idx, nodes_per_elem, Shp, ShpDer, Jacobian, E10, q, uuu, uup, E1 )
    
    tolerance = AdjustTol(accuracy, Base_uuu)
    @assertEqual(Base_uuu, uuu(:, :, 1), tolerance, testname)
    tolerance = AdjustTol(accuracy, Base_uup)
    @assertEqual(Base_uup, uup(:, :, 1), tolerance, testname)
    tolerance = AdjustTol(accuracy, Base_E1)
    @assertEqual(Base_E1, E1(:, :, 1), tolerance, testname)
    
    ! --------------------------------------------------------------------------
    
end subroutine test_BD_DisplacementQP
